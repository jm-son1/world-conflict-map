<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ì„¸ê³„ ë¶„ìŸ ì§€ë„ ì˜ê²¬ ê³µìœ </title>

<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script src="https://cdn.jsdelivr.net/npm/wordcloud@1.1.2/src/wordcloud2.js"></script>

<style>
  body { margin:0; font-family: Arial, sans-serif; }
  h2 { margin: 10px; }
  #map { height: 55vh; }
  #panel { padding: 15px; }

  textarea {
    width: 100%;
    height: 70px;
    margin-top: 8px;
  }

  button {
    margin-top: 8px;
    padding: 8px 14px;
  }

  .comment {
    padding: 8px;
    margin-top: 6px;
    background: #f2f2f2;
    border-radius: 5px;
  }

  #newsLink {
    display: inline-block;
    margin-top: 6px;
    margin-bottom: 10px;
  }

  #wordCloudCanvas {
    border: 1px solid #ccc;
    margin-top: 10px;
    width: 100%;
    height: 200px;
  }
</style>
</head>

<body>

<h2>ğŸŒ ì„¸ê³„ ë¶„ìŸ ì§€ì—­ ì˜ê²¬ ê³µìœ  ì§€ë„</h2>

<div id="map"></div>

<div id="panel">
  <h3 id="title">ì§€ì—­ì„ ì„ íƒí•˜ì„¸ìš”</h3>
  <p id="desc"></p>

  <a id="newsLink" href="#" target="_blank" style="display:none;">
    ğŸ”— ê´€ë ¨ ë‰´ìŠ¤ ê¸°ì‚¬ ë³´ê¸°
  </a>

  <textarea id="commentInput" placeholder="ë‰´ìŠ¤ë¥¼ ì°¸ê³ í•´ ìì‹ ì˜ ì˜ê²¬ì„ ì‘ì„±í•˜ì„¸ìš”"></textarea><br>
  <button onclick="saveComment()">ì˜ê²¬ ë“±ë¡</button>

  <!-- ì›Œë“œí´ë¼ìš°ë“œ -->
  <canvas id="wordCloudCanvas"></canvas>

  <p>ì´ ì˜ê²¬ ìˆ˜: <span id="count">0</span></p>
  <div id="comments"></div>
</div>

<script>
  const map = L.map('map').setView([25, 20], 2);

  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: 'Â© OpenStreetMap'
  }).addTo(map);

  /* ë¶„ìŸ ì§€ì—­ ë°ì´í„° */
  const regions = {
    ukraine: {
      name: "ìš°í¬ë¼ì´ë‚˜ ì „ìŸ",
      desc: "ëŸ¬ì‹œì•„ì˜ êµ°ì‚¬ ê°œì…ê³¼ êµ­ì œ ì§ˆì„œì— ë¯¸ì¹˜ëŠ” ì˜í–¥",
      lat: 48.5, lng: 31,
      news: "https://www.voakorea.com/a/7975108.html"
    },
    korea: {
      name: "í•œë°˜ë„ í•µ ë¬¸ì œ",
      desc: "ë¶í•œì˜ í•µ ê°œë°œê³¼ ë™ë¶ì•„ ì•ˆë³´ í™˜ê²½",
      lat: 38, lng: 127,
      news: "https://www.joongang.co.kr/article/25389823"
    },
    israel: {
      name: "ì´ìŠ¤ë¼ì—˜-íŒ”ë ˆìŠ¤íƒ€ì¸ ë¶„ìŸ",
      desc: "ì˜í† ì™€ ë¯¼ì¡± ìê²°ê¶Œì„ ë‘˜ëŸ¬ì‹¼ ì¥ê¸°ì  ê°ˆë“±",
      lat: 31.5, lng: 35,
      news: "http://newstapa.org/article/Kbd1Z"
    },
    taiwan: {
      name: "ëŒ€ë§Œ í•´í˜‘ ê¸´ì¥",
      desc: "í•˜ë‚˜ì˜ ì¤‘êµ­ ì›ì¹™ê³¼ ëŒ€ë§Œì˜ ì •ì¹˜ì  ì§€ìœ„ ë¬¸ì œ",
      lat: 23.7, lng: 121,
      news: "https://www.hani.co.kr/arti/politics/defense/1060607.html"
    },
    nepal: {
      name: "ë„¤íŒ” ë°˜ì •ë¶€ ì‹œìœ„",
      desc: "ì •ì¹˜ì  ë¶ˆì•ˆê³¼ ì‚¬íšŒì  ê¸´ì¥",
      lat: 28.2, lng: 84.5,
      news: "https://www.joongang.co.kr/article/25365692"
    },
    turkey_syria: {
      name: "íŠ€ë¥´í‚¤ì˜ˆ-ì‹œë¦¬ì•„ ë¶„ìŸ",
      desc: "ì¿ ë¥´ë“œ ë¬¸ì œì™€ êµ­ê²½ ì•ˆë³´ ì¶©ëŒ",
      lat: 37, lng: 38,
      news: "https://www.voakorea.com/a/7686742.html"
    },
    yemen: {
      name: "ì˜ˆë©˜ ë‚´ì „",
      desc: "í›„í‹° ë°˜êµ°ê³¼ ì •ë¶€êµ° ê°„ì˜ ì¥ê¸°ì  ê°ˆë“±",
      lat: 15.3, lng: 44,
      news: "https://www.voakorea.com/a/4670960.html"
    },
    myanmar: {
      name: "ë¯¸ì–€ë§ˆ ì¿ ë°íƒ€",
      desc: "êµ°ë¶€ì˜ ê¶Œë ¥ ì¥ì•…ê³¼ ë¯¼ì£¼í™” ìš´ë™ íƒ„ì••",
      lat: 21.9, lng: 95.9,
      news: "https://www.voakorea.com/a/6946829.html"
    },
    beirut: {
      name: "ë² ì´ë£¨íŠ¸ ì¢…êµë¶„ìŸ",
      desc: "ì¢…íŒŒ ê°„ ê¸´ì¥ê³¼ í­ë ¥ ì‚¬ê±´",
      lat: 33.9, lng: 35.5,
      news: "https://www.hankookilbo.com/News/Read/A2020100723390003596"
    },
    congo: {
      name: "ì½©ê³  êµ­ì œë¶„ìŸ",
      desc: "ìì›ê³¼ ë¯¼ì¡± ê°ˆë“±ìœ¼ë¡œ ì¸í•œ ë‚´ì „",
      lat: -0.5, lng: 15,
      news: "https://v.daum.net/v/20251215173115644"
    },
    us_mexico: {
      name: "ë¯¸êµ­-ë©•ì‹œì½” êµ­ê²½ ê°ˆë“±",
      desc: "ë¶ˆë²• ì´ë¯¼ê³¼ ë§ˆì•½ ë¬¸ì œë¡œ ì¸í•œ ê¸´ì¥",
      lat: 31.5, lng: -106,
      news: "https://www.hani.co.kr/arti/international/america/1147306.html"
    }
  };

  let currentKey = null;

  Object.keys(regions).forEach(key => {
    const r = regions[key];
    L.marker([r.lat, r.lng])
      .addTo(map)
      .on('click', () => selectRegion(key));
  });

  function selectRegion(key) {
    currentKey = key;

    document.getElementById('title').innerText = regions[key].name;
    document.getElementById('desc').innerText = regions[key].desc;

    const link = document.getElementById('newsLink');
    link.href = regions[key].news;
    link.style.display = "inline-block";

    loadComments();
  }

  function saveComment() {
    if (!currentKey) {
      alert("ì§€ì—­ì„ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”");
      return;
    }

    const text = document.getElementById('commentInput').value.trim();
    if (!text) return;

    const data = JSON.parse(localStorage.getItem(currentKey) || '[]');
    data.push(text);
    localStorage.setItem(currentKey, JSON.stringify(data));

    document.getElementById('commentInput').value = "";
    loadComments();
  }

  function loadComments() {
    const box = document.getElementById('comments');
    box.innerHTML = "";

    const data = JSON.parse(localStorage.getItem(currentKey) || '[]');
    document.getElementById('count').innerText = data.length;

    data.forEach(c => {
      const div = document.createElement("div");
      div.className = "comment";
      div.innerText = c;
      box.appendChild(div);
    });

    // ì›Œë“œí´ë¼ìš°ë“œ ìƒì„±
    const words = [];
    data.join(" ").split(/\s+/).forEach(word => {
      if(word.length > 1) words.push([word, 10 + Math.random() * 20]);
    });

    WordCloud(document.getElementById('wordCloudCanvas'), {
      list: words,
      gridSize: 8,
      weightFactor: 3,
      fontFamily: 'Arial',
      color: 'random-dark',
      backgroundColor: '#f8f8f8'
    });
  }
</script>

</body>
</html>

